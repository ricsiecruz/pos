<div class="inventory">
    <div class="inventory_title">
        Expenses
        <div class="inventory_title_add" (click)="openAddInventoryModal(addInventoryModal)">
            Add expense
        </div>
    </div>
    <div class="inventory_table">
        <div class="inventory_table_credit">
          Credit
          <div>
            PHP {{ credit | number:'1.2-2' }}
          </div>
        </div>
        <div class="inventory_table_header">
            <div class="table_one">Expense</div>
            <div class="table_four">Amount</div>
            <div class="table_two">Month</div>
            <div class="table_three">Date</div>
            <div class="table_five">Mode of payment</div>
            <div class="table_six"></div>
            <div></div>
        </div>
        <div class="inventory_table_list" *ngFor="let data of expenses">
            <div class="table_one">
                {{ data.expense }}
            </div>
            <div class="table_four">
                PHP {{ data.amount }}
            </div>
            <div class="table_two">
                {{ data.month }}
            </div>
            <div class="table_three">
                {{ data.date | date:"EEEE, MMMM d, y, h:mm:ss" }}
            </div>
            <div class="table_five">
                {{ data.mode_of_payment }}
            </div>
            <div class="table_six">
              <!-- <div *ngIf="data.credit == true" (click)="payExpense(data)">pay</div> -->
              <div *ngIf="data.credit == true" (click)="payModal(data)">pay</div>
            </div>            
            <div (click)="view(data)">view</div>
        </div>
    </div>
</div>

<ng-template #pay let-d="dismiss">
  <div class="modal-header">
    Pay {{ details.expense }}
  </div>
  <div class="modal-body">
    <p>You are about to pay PHP {{ details.amount }} to {{ details.paid_by }} for {{ details.expense }}. Are you sure?</p>
    <label class="modal-body-label" for="mode_of_payment">Mode of payment:</label>
    <ng-select [(ngModel)]="selected_mode_of_payment" name="mode_of_payment">
      <ng-option *ngFor="let data of mode_of_payment" [value]="data.id">{{ data.mode_of_payment }}</ng-option>
    </ng-select>
    <div (click)="payExpense(details)">yes</div>
    <div (click)="d()">no</div> <!-- Dismiss the modal -->
  </div>
</ng-template>

<ng-template #sales let-d="dismiss">
    <div class="modal-header">
        View {{ details.expense }}
      </div>
      <div class="modal-body">
        <label>Month</label>
        <input class="form-control" [value]="details.month" disabled >
        <label>Amount</label>
        <input class="form-control" [value]="details.amount" disabled >
        <label>mode_of_payment</label>
        <input class="form-control" [value]="details.mode_of_payment" disabled >
        <label>Date</label>
        <div class="modal-date">{{ details.date | date:"EEEE, MMMM d, y, h:mm:ss" }}</div>
        <img src="http://localhost:3000{{details.image_path}}" style="width: 200px;" *ngIf="details.image_path != null" >
      </div>
</ng-template>

<ng-template #addInventoryModal let-d="dismiss">
    <div class="modal-header">
      Add expense
    </div>
    <div class="modal-body">
      <form (submit)="addProduct()">
        <label class="modal-body-label" for="productName">expense:</label>
        <input class="form-control" type="text" id="productName" name="productName" [(ngModel)]="newExpenses.expense" required>
        <label class="modal-body-label" for="categoryName">amount:</label>
        <input class="form-control" type="number" id="categoryName" name="categoryName" [(ngModel)]="newExpenses.amount" required>
  
        <!-- <label class="modal-body-label" for="image">Image:</label>
        <input class="form-control" type="file" id="image" name="image" (change)="onFileSelected($event)">
  
        <div *ngIf="imagePreviewUrl">
          <img [src]="imagePreviewUrl" alt="Image Preview" style="max-width: 100%; height: auto;"/>
        </div> -->

        <label class="modal-body-label" for="paidBy">Paid By:</label>
        <ng-select [(ngModel)]="newExpenses.paid_by" name="paidBy">
          <ng-option *ngFor="let data of paidBy" [value]="data.name">{{ data.name }}</ng-option>
        </ng-select>


        <div *ngIf="newExpenses.paid_by == 'Tech Hybe'"> <!-- Compare with id instead of name -->
          <label class="modal-body-label" for="mode_of_payment">Mode of payment:</label>
          <ng-select [(ngModel)]="newExpenses.mode_of_payment" name="mode_of_payment">
            <ng-option *ngFor="let data of mode_of_payment" [value]="data.id">{{ data.mode_of_payment }}</ng-option>
          </ng-select>
        </div>
  
        <div class="modal-btns">
          <button class="btn modal-btns-cancel" (click)="cancelForm()" type="button">Cancel</button>
          <button class="btn modal-btns-add" type="submit">
            Add
          </button>
        </div>
      </form>
    </div>
  </ng-template>
  
